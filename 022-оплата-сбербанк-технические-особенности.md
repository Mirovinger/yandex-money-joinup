<!--
https://yandex.ru/support/checkout/instructions/sberbank.html
-->

<img src="/i/sbol-logo-ru.jpg" width="200" />

технические особенности платежного метода
==========================================================

## Шаги оплаты Сбербанк-онлайн
Вне зависимости от того, самописный у вас сайт или он сделан на основе "CMS + платежный модуль", технически любой платеж формируется одинаково.
| Шаг     | Описание                                 | 
| ------- | ---------------------------------------- |
| <img src="/i/merchant-site-with-pay-button-sample.png" /> | **Шаг 1** <br> `с вашего сайта, после нажатия кнопки "заплатить" в систему Яндекс.Касса передаются параметры платежного протокола и необходимые значения`, при этом кроме основных данных платежной форме вы передаете платежный метод ```html <input required name="paymentType" value="SB"/>``` или не передаете (тогда страница оплаты будет такой). <br> Если все переданные значения корректные, то вы переходите к Шагу-2. Если в значениях параметров есть ошибка или не передан обязательный параметр или метод "Сбербанк-онлайн" вам не подключен (или отключен), то вместо Шага-2 плательщик увидит [страницу с ошибкой](#technical-error). |
| ![пример платежной страниц сбербанк-онлайн](/i/sberbank-online-sample-payment-page.png "пример платежной страниц сбербанк-онлайн") | **Шаг 2** <br >Эту страницу вы увидите после шага-1, если вашему магазину доступен Сбербанк-онлайн в режиме смс и в режиме оплаты через личный кабинет Сбербанка.|
| ![пример сообщения, которое вы видите, если магазину запрещена оплата сбербанк-онлайн через смс и доступен только метод оплаты через личный кабинет сбербанка](/i/sberbank-online-sample-prepay-page-to-redirect.png "пример сообщения, которое вы видите, если магазину запрещена оплата сбербанк-онлайн через смс и доступен только метод оплаты через личный кабинет сбербанка") | **Шаг 2.1** <br> 2. Если магазину запрещена оплата сбербанк-онлайн через смс и доступен только метод оплаты через личный кабинет сбербанка, после шага-1 плательщик увидит такую страницу |
| ![пример страницы авторизации в ЛК сбербанка](/i/sberbank-online-sample-sberLK-main-page.png "пример страницы авторизации в ЛК сбербанка") | 2.1 А затем будет автоматические редирект на страницу [личного кабинета Сбербанк-онлайн](https://online.sberbank.ru/)|


## Ошибки


| Пример  | Причины                                  | 
| ------- | ---------------------------------------- |
| <img src="/i/sberbank-online-sample-error-msg1.png" width="450" /> | <a name="technical-error"></a>**Не получилось. Техническая ошибка. Вариант 1** <br> * платежный метод вам не подключен (с момента начала регистрации метода для вашего магазина может пройти 1-2 недели, прежде, чем метод вам будет подключен; время требуется на все этапы регистрации); если метод работал, но вы получаете эту ошибку, возможно, вам отключили этот метод, уточните у вашего менеджера;|
|         | **Не получилось. Техническая ошибка. Вариант 2** <br> * в одном из параметров вы передаете неправильное или недопустимой значение; если не можете определить что, напишите нашим специалистам, они помогут.|
| <img src="/i/sberbank-online-sample-error-expire-contract-page.png" width="450" /> | **Что-то пошло не так** <br> Пример ошибки сбербанк-онлайн, в случае, когда плательщик открыл страницу из шага-2 и не выполнил оплату после в течении часа |
| ![В Сбербанке Онлайн нет такого аккаунта. Заплатите другим способом.](/i/sberbank-online-sample-error-user-phone-not-found.png "В Сбербанке Онлайн нет такого аккаунта. Заплатите другим способом.") | **Не получилось. В Сбербанке Онлайн нет такого аккаунта. Заплатите другим способом.** <br> Если на шаге-2 в поле для телефона был указан телефон, к номеру которого не привязан аккаунт в сбербанк-онлайн, то плательщик получит такое соообщение: `В Сбербанке Онлайн нет такого аккаунта. Заплатите другим способом.` |

### checkOrder
Если Ваш URL для обработки checkOrder уведомлений не ответил нашей системе коррректно или был не доступен (надо понимать, что уведомление checkOrder наша система доставляет только один раз), при этом на стороне Сбербанка этот платеж будет считаться успешным, плательщик в личном кабинете Сбербанка будет видеть чек успешной оплаты. Но, т.к. ваша система не ответила корректно на наш запрос checkOrder, заказ считается ошибочным. Далее мы инициируем отмену платежа в Сбербанке (процедура занимает в пределах трех рабочих дней).
